kind: ConfigMap
apiVersion: v1
metadata:
  name: "{{ ansible_operator_meta.name }}-dnsmasq-config"
  namespace: "{{ ansible_operator_meta.namespace }}"
data:
  dnsmasq.conf: |
    bind-interfaces
    interface={{ interfaces.inside[0].name }}
    dhcp-range={{ dhcp.startIP }},{{ dhcp.endIP }},{{ dhcp.mask }},{{ dhcp.leaseTime }}
    dhcp-option=option:router,{{ dhcp.gateway }}
    dhcp-option=option:dns-server,{{ dhcp.dnsServer }}
    dhcp-authoritative
    domain={{ dhcp.domain }}
{% for item in dns.upstreamServers %}
    server={{ item }}
{% endfor %}
